<html>
<head>
<title>Compiler Option: -entry</title>
<link rel="stylesheet" type="text/css" href="style.css">
<meta charset="UTF-8">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Compiler Option: -entry</div>
<div id="fb_tab_r">&nbsp;<a href="00index.html"><img src="images/fblogo_mini.gif" /></a></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Override the public exported name of the implicit user main function<br \>
<br \>
<div class="fb_sect_title">Syntax</div><div class="fb_sect_cont"><tt><br \>
<div class="fb_indent"><b>-entry</b> &lt; <i>name</i> &gt;<br \>
</div></tt><br \>
</div><div class="fb_sect_title">Parameters</div><div class="fb_sect_cont"><br \>
<div class="fb_indent"><tt><i>name</i></tt><br \>
<div class="fb_indent">The custom name that overrides the public exported name of the implicit user main function<br \>
<br \>
</div></div></div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
<div class="fb_indent">The <tt>-entry</tt> compiler option changes the name of the publicly export symbol of the implicit user main function (automatically generated by fbc as start-up code).<br \>
It affects the start-up code and implicit user main, which is also affected by the module being the main module or not.<br \>
<br \>
By default, fbc defines a publicly exported 'main' symbol in the main module as required by the run time start-up system code.<br \>
There is no other way currently to override fbc's use of the 'main' symbol other than to always compile and link separately.<br \>
<br \>
Proceedings:<br \>
<div class="fb_indent"><b>-</b> The custom main function name must only be declared with the following signature (same parameter types, same return type, same calling convention) to be compatible with the (basic) main function:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="com">''&nbsp;internally&nbsp;the&nbsp;implicit&nbsp;main&nbsp;function&nbsp;is&nbsp;now&nbsp;named&nbsp;&quot;custom_main&quot;</span><br />
<span class="key">Declare</span>&nbsp;<span class="key">Function</span>&nbsp;<span class="wrd">custom_main</span>&nbsp;<span class="key">cdecl</span>&nbsp;<span class="key">Alias</span>&nbsp;<span class="quo">&quot;custom_main&quot;</span>&nbsp;<span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">argc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><span class="oth">,</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">argv</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">ZString</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
</div><b>-</b> The (basic) main function must also be provided to satisfy the linker and start-up code. This might be defined in another libray or framework, in C, or ASM, or fb language as shown by the following minimum code example:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Function</span>&nbsp;<span class="wrd">main</span>&nbsp;<span class="key">cdecl</span>&nbsp;<span class="key">Alias</span>&nbsp;<span class="quo">&quot;main&quot;</span>&nbsp;<span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">argc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><span class="oth">,</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">argv</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">ZString</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;.....</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;call&nbsp;the&nbsp;custom&nbsp;main</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="wrd">custom_main</span><span class="oth">(</span>&nbsp;<span class="wrd">argc</span><span class="oth">,</span>&nbsp;<span class="wrd">argv</span>&nbsp;<span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
</div><b>-</b> Then compile with the <tt>-entry custom_main</tt> option.<br \>
<br \>
</div><b>Note:</b><br \>
<div class="fb_indent">This feature is being developed (fbc version 1.09) and may change in future (see <tt><a href="https://www.freebasic.net/forum/viewtopic.php?f=9&t=29504">Compiler Option: -entry</a></tt> in Documentation forum).<br \>
There will maybe a better way to deal with this: a compiler option that lets to outright specify an explicit "main".<br \>
<br \>
</div></div></div><div class="fb_sect_title">Example</div><div class="fb_sect_cont"><br \>
<div class="fb_indent">Example of program (<tt>option_entry.bas</tt>) trying to show the minimal code for fb language only:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="com">''&nbsp;option_entry.bas:</span><br />
<br />
<span class="com">''&nbsp;-&nbsp;demonstrate&nbsp;alternate&nbsp;named&nbsp;main&nbsp;function</span><br />
<span class="com">''&nbsp;&nbsp;&nbsp;as&nbsp;an&nbsp;alternate&nbsp;entry&nbsp;point&nbsp;for&nbsp;the&nbsp;implicit&nbsp;user&nbsp;main</span><br />
<span class="com">''&nbsp;-&nbsp;we&nbsp;also&nbsp;can&nbsp;compile&nbsp;and&nbsp;link&nbsp;in&nbsp;separate&nbsp;steps</span><br />
<br />
<span class="com">''&nbsp;compile:&nbsp;$&nbsp;fbc&nbsp;-c&nbsp;-m&nbsp;option_entry&nbsp;option_entry.bas&nbsp;-entry&nbsp;custom_main</span><br />
<span class="com">''&nbsp;compile:&nbsp;$&nbsp;fbc&nbsp;option_entry.o</span><br />
<span class="com">''&nbsp;OR</span><br />
<span class="com">''&nbsp;compile:&nbsp;$&nbsp;fbc&nbsp;option_entry.bas&nbsp;-entry&nbsp;custom_main</span><br />
<br />
<br />
<span class="com">''&nbsp;internally&nbsp;the&nbsp;implicit&nbsp;main&nbsp;function&nbsp;is&nbsp;now&nbsp;named&nbsp;&quot;custom_main&quot;</span><br />
<span class="key">Declare</span>&nbsp;<span class="key">Function</span>&nbsp;<span class="wrd">custom_main</span>&nbsp;<span class="key">cdecl</span>&nbsp;<span class="key">Alias</span>&nbsp;<span class="quo">&quot;custom_main&quot;</span>&nbsp;<span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">argc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><span class="oth">,</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">argv</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">ZString</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><br />
<br />
<span class="com">''&nbsp;But&nbsp;we&nbsp;still&nbsp;need&nbsp;a&nbsp;main()&nbsp;function&nbsp;to&nbsp;satisfy&nbsp;the&nbsp;linker&nbsp;and&nbsp;start-up&nbsp;code</span><br />
<span class="com">''&nbsp;-&nbsp;this&nbsp;might&nbsp;be&nbsp;defined&nbsp;in&nbsp;another&nbsp;libray&nbsp;or&nbsp;framework</span><br />
<span class="com">''&nbsp;-&nbsp;it's&nbsp;not&nbsp;so&nbsp;let's&nbsp;define&nbsp;it&nbsp;here&nbsp;for&nbsp;the&nbsp;demonstration</span><br />
<span class="key">Function</span>&nbsp;<span class="wrd">main</span>&nbsp;<span class="key">cdecl</span>&nbsp;<span class="key">Alias</span>&nbsp;<span class="quo">&quot;main&quot;</span>&nbsp;<span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">argc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><span class="oth">,</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">argv</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">ZString</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;just&nbsp;call&nbsp;our&nbsp;custom&nbsp;main&nbsp;for&nbsp;demonstration</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="wrd">custom_main</span><span class="oth">(</span>&nbsp;<span class="wrd">argc</span><span class="oth">,</span>&nbsp;<span class="wrd">argv</span>&nbsp;<span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
<br />
<br />
<span class="com">''&nbsp;---------------------------------</span><br />
<span class="com">''&nbsp;START&nbsp;OF&nbsp;USER'S&nbsp;IMPLICIT&nbsp;MAIN</span><br />
<span class="com">''&nbsp;internally&nbsp;this&nbsp;is&nbsp;named&nbsp;&quot;custom_main&quot;&nbsp;and&nbsp;will&nbsp;automatically&nbsp;be</span><br />
<span class="com">''&nbsp;called&nbsp;by&nbsp;our&nbsp;custom&nbsp;frame&nbsp;work</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;hello&quot;</span><br />
<span class="key">Sleep</span><br />
<br />
<span class="com">''&nbsp;END&nbsp;OF&nbsp;USER'S&nbsp;IMPLICIT&nbsp;MAIN</span><br />
<span class="com">''&nbsp;---------------------------------</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
</div></div></div><div class="fb_sect_title">See also</div><div class="fb_sect_cont"><br \>
<ul><li> <a href="CompilerOptm.html">Compiler Option: -m</a><br \>
<li> <a href="ProPgExecutables.html">Executables</a><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
