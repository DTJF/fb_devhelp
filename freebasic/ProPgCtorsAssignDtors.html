<html>
<head>
<title>Constructors, '=' Assignment-Operators, and Destructors (advanced, part #1)</title>
<link rel="stylesheet" type="text/css" href="style.css">
<meta charset="UTF-8">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Constructors, '=' Assignment-Operators, and Destructors (advanced, part #1)</div>
<div id="fb_tab_r">&nbsp;<a href="00index.html"><img src="images/fblogo_mini.gif" /></a></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Proper use of <b>Constructors</b>, '=' <b>Assignment-Operators</b>, and <b>Destructors</b>, which are the special member procedures for constructing/initializing, assigning, and destroying objects (part #1).<br \>
<a name="ProPgCtorsAssignDtorsTop"></a><br \>
<b>Preamble:</b><br \>
<br \>
Some member procedures, which have a predefined name in the Type, have a specific role that is constructing, assigning, and destroying objects. These are the constructors, the '=' assignment-operators, and the destructor.<br \>
Of these, some are special because a version will be automatically built by the compiler if they are needed and not explicitly defined by the user. These are the default-constructor, the copy-constructor, the copy-assignment operator, and the destructor.<br \>
<br \>
It is therefore often necessary that user defines its own explicit versions in order to execute actions that must take place during all lifetime of an object:<br \>
<div class="fb_indent"><b>-</b> For example, if the object contains dynamically allocated variables, it is necessary to reserve them memory when the object is created.<br \>
<b>-</b> For object assignment, the memory must often be reallocated.<br \>
<b>-</b> At the destruction of the object, it is necessary to free the allocated memory.<br \>
<br \>
</div>Once the user defines any explicit constructor or explicit destructor, the compiler no longer automatically defines the implicit default constructor or the implicit destructor.<br \>
In particular, if the user only defines an explicit constructor taking parameters, it will no longer be possible to simply construct an object, without providing the parameters to this constructor, unless, of course, the user defines also an explicit default constructor (the one which does not take parameters).<br \>
<br \>
Type inheritance and virtuality must also be taken into account for defining these special member procedures.<br \>
<br \>
As any member, these special member procedures may have any accessibility, public, protected or private (but a private access does not have much interest, and even can totally prevent any direct or derived object construction).<br \>
<br \>
<u>Table of Contents</u><br \>
<div class="fb_indent"><b><a href="#ProPgCtorsAssignDtors1">1. Constructors and destructors</a></b><br \>
<b><a href="#ProPgCtorsAssignDtors2">2. '=' Assignment-operators</a></b><br \>
<b><a href="#ProPgCtorsAssignDtors3">3. Processing variable-length arrays as members of Type</a></b><br \>
<br \>
</div><a name="ProPgCtorsAssignDtors1"></a><br \>
<div class="fb_sect_title">1. Constructors and destructors</div><div class="fb_sect_cont"><br \>
A constructor is called automatically when instantiating the object. The destructor is called automatically when it is destroyed.<br \>
This destruction occurs when outputting the current scope block for auto storage kind objects.<br \>
<br \>
For dynamically allocated objects, the constructor and destructor are automatically called by expressions that use the 'New', 'New[]', and 'Delete', 'Delete[]' operators. That is why it is recommended to use them instead of the '[C|Re]]Allocate' and 'Deallocate' functions to dynamically create objects.<br \>
Also, do not use 'Delete' or 'Delete[]' on 'Any Ptr' pointers, because the compiler must determine which destructor to call with the type of pointer.<br \>
<br \>
<u>Definition of constructors and destructors</u><br \>
<div class="fb_indent">The constructor is called after the memory allocation of the object and the destructor is called before this memory is freed. The management of the dynamic allocation of memory with the Types is thus simplified.<br \>
In the case of member object fields, the order of construction is that of their declarations, and the order of destruction is the reverse. It is in this order that the constructors and destructors of each member object field are called.<br \>
<br \>
The explicit constructors may have parameters. They can be overloaded, but not the explicit destructors. This is because in general one knows the context in which an object is created, but one cannot know the context in which it is destroyed: there can only be one destructor.<br \>
Constructors that do not take a parameter or with all parameters having a default value, automatically replace the default constructors defined by the compiler if there were no explicitly defined constructors in the Types. This means that these constructors will be called automatically by the default constructors of the derived Types.<br \>
<br \>
Example - Constructors and destructor ('ZstringChain' Type):<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;implement&nbsp;a&nbsp;zstring&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">ZString</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="wrd">pz</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;define&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;default&nbsp;constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">size</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;constructor&nbsp;with&nbsp;as&nbsp;parameter&nbsp;the&nbsp;chain&nbsp;size</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Destructor</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;destructor</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;&nbsp;<span class="com">''&nbsp;reset&nbsp;the&nbsp;chain&nbsp;pointer</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">size</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">CAllocate</span><span class="oth">(</span><span class="wrd">size</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span><span class="oth">,</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="key">ZString</span><span class="oth">))</span>&nbsp;&nbsp;<span class="com">''&nbsp;allocate&nbsp;memory&nbsp;for&nbsp;the&nbsp;chain</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Destructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Deallocate</span>&nbsp;<span class="wrd">This.pz</span>&nbsp;&nbsp;<span class="com">''&nbsp;free&nbsp;the&nbsp;allocated&nbsp;memory&nbsp;if&nbsp;necessary</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;reset&nbsp;the&nbsp;chain&nbsp;pointer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<span class="key">End</span>&nbsp;<span class="key">Destructor</span><br />
<br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="wrd">zc1</span>&nbsp;&nbsp;<span class="com">''&nbsp;instantiate&nbsp;a&nbsp;non&nbsp;initialized&nbsp;chain&nbsp;:&nbsp;useless</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="wrd">zc2</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">(</span><span class="num">9</span><span class="oth">)</span>&nbsp;&nbsp;<span class="com">''&nbsp;instantiate&nbsp;a&nbsp;szstring&nbsp;chain&nbsp;of&nbsp;9&nbsp;useful&nbsp;characters</span><br />
<span class="com">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;shortcut:&nbsp;Dim&nbsp;As&nbsp;ZstringChain&nbsp;zc2&nbsp;=&nbsp;9</span><br />
<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">&quot;FreeBASIC&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;fill&nbsp;up&nbsp;the&nbsp;chain&nbsp;with&nbsp;9&nbsp;characters</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc2&nbsp;chain:&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;chain</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output:<br \>
<div class="fb_indent"><pre class="fb_pre">
zc2 chain:
'FreeBASIC'
				</pre></div></div>The constructors will sometimes have to perform more complicated tasks than those given in this example. In general, they can do all the feasible operations in a normal member procedure, except using uninitialized data of course.<br \>
In particular, the data of inherited objects are not initialized as long as the constructors of the base-Types are not called. For this reason, the constructors of the base-Types must always be called before running the constructor of the Type being instantiated.<br \>
If the constructors of the base-Types are not explicitly called, the compiler will call, by default, the constructors of the base-Types that do not take a parameter or whose parameters have a default value (and, if no such a constructor is explicitly defined in the base-Types, it will call the implicit default constructors of these Types).<br \>
<br \>
</div><u>Constructors</u><br \>
<div class="fb_indent">A constructor is a kind of member procedure that initializes an instance of its Type. A constructor has the same name as the Type and no return value. A constructor can have any number of parameters and a Type may have any number of overloaded constructors.<br \>
<br \>
If not any constructor is explicitly defined, the compiler will generate (if needed) a default-constructor that takes no parameters. The user can cancel this behavior by declaring and defining explicitly its own default-constructor.<br \>
If the user defines his own constructor(s), implicit default-initialization operations are always done prior to the user's constructor(s) code execution.<br \>
<br \>
Order of Construction:<br \>
<div class="fb_indent"><b>-</b> The Type constructor is called.<br \>
<b>-</b> The base Types and their member constructors are called in the order of declaration.<br \>
<b>-</b> If the Type has virtual member procedures (including these inherited from its Base), the virtual-pointer (vptr) is set to point to the virtual-table (vtbl) of the Type.<br \>
<b>-</b> The body of the Type constructor procedure is executed.<br \>
<br \>
</div><b>Default-constructor:</b><br \>
<div class="fb_indent">The default-constructor has no parameters.<br \>
It follows slightly different rules:<br \>
<div class="fb_indent"><b>-</b> The default-constructor is one of the special member functions.<br \>
<b>-</b> If no constructors are explicitly declared in a Type, the compiler provides a default-constructor.<br \>
<b>-</b> If any non default-constructors are declared, the compiler does not provide a default-constructor and the user is forced to declare one if necessary.<br \>
<br \>
</div></div><b>Conversion-constructors:</b><br \>
<div class="fb_indent">If a Type has a constructor with a single parameter, or if at least all other parameters have a default value, the type of the first argument can be implicitly converted to the type of the Type by the compiler.<br \>
In such expressions, the term <i>'variable'</i> may be considered as a short-cut of <i>'typename(variable)'</i>.<br \>
<br \>
Such conversions can be useful in some cases, but more often they can lead to poor readability (in these cases, it is better to explicitly call the matching constructor).<br \>
<br \>
Example - Implicit conversion:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="key">Extends</span>&nbsp;<span class="key">Object</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">i0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Destructor</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">i</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;UDT.default-constructor&quot;</span><span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="key">This</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">i0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;UDT.conversion-constructor&quot;</span><span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="key">This</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">i0</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Function</span>&nbsp;<span class="wrd">RtnI</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="wrd">u.i</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
&nbsp;<br />
<span class="key">Destructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;UDT.destructor&quot;</span><span class="oth">,</span>&nbsp;<span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="key">This</span><br />
<span class="key">End</span>&nbsp;<span class="key">Destructor</span><br />
<br />
<span class="key">Scope</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Construction:&nbsp;'Dim&nbsp;As&nbsp;UDT&nbsp;u'&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Assignment:&nbsp;'u&nbsp;=&nbsp;123'&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">RtnI</span><span class="oth">(</span><span class="num">123</span><span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;&nbsp;RtnI(123):&nbsp;implicite&nbsp;conversion&nbsp;using&nbsp;the&nbsp;conversion-constructor,</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;short_cut&nbsp;of&nbsp;RtnI(UDT(123))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Going&nbsp;out&nbsp;scope:&nbsp;'End&nbsp;Scope'&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">Scope</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output example:<br \>
<div class="fb_indent"><pre class="fb_pre">
Construction: 'Dim As UDT u'
   => UDT.default-constructor             1703588

Assignment: 'u = 123'
   => UDT.conversion-constructor          1703580
	  123
   => UDT.destructor                      1703580

Going out scope: 'End Scope'
   => UDT.destructor                      1703588
					</pre></div></div>But such conversions can even lead to subtle but serious errors in the code.<br \>
<br \>
Example - Subtle/Serious errors in the code:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">point2D</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">x0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><span class="oth">,</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">y0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Operator</span>&nbsp;<span class="key">Cast</span>&nbsp;<span class="oth">()</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">x</span><span class="oth">,</span>&nbsp;<span class="wrd">y</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">point2D</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">x0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><span class="oth">,</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">y0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.x</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">x0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.y</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">y0</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Operator</span>&nbsp;<span class="wrd">point2D.cast</span>&nbsp;<span class="oth">()</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="quo">&quot;(&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">This.x</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;,&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">This.y</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;)&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">Operator</span><br />
<br />
<span class="key">Operator</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">v0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">point2D</span><span class="oth">,</span>&nbsp;<span class="key">ByRef</span>&nbsp;<span class="wrd">v1</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">point2D</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">point2D</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="key">Type</span><span class="oth">(</span><span class="wrd">v0.x</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="wrd">v1.x</span><span class="oth">,</span>&nbsp;<span class="wrd">v0.y</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="wrd">v1.y</span><span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Operator</span><br />
<br />
<span class="key">Operator</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">v0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">point2D</span><span class="oth">,</span>&nbsp;<span class="key">ByRef</span>&nbsp;<span class="wrd">v1</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">point2D</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="wrd">v0.x</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="wrd">v1.x</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="wrd">v0.y</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="wrd">v1.y</span><br />
<span class="key">End</span>&nbsp;<span class="key">Operator</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;Construction&nbsp;of&nbsp;v1:&nbsp;'Dim&nbsp;As&nbsp;point2D&nbsp;v1&nbsp;=&nbsp;point2D(2,&nbsp;3)'&quot;</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">point2D</span>&nbsp;<span class="wrd">v1</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">point2D</span><span class="oth">(</span><span class="num">2</span><span class="oth">,</span>&nbsp;<span class="num">3</span><span class="oth">)</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;=&gt;&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">v1</span><br />
<span class="key">Print</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;Addition&nbsp;to&nbsp;v1:&nbsp;'v1&nbsp;+&nbsp;4'&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;=&gt;&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">v1</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;&nbsp;4:&nbsp;implicite&nbsp;conversion&nbsp;using&nbsp;the&nbsp;conversion-constructor,</span><br />
<span class="com">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;short_cut&nbsp;of&nbsp;point2D(4,&nbsp;)&nbsp;or&nbsp;point2D(4)</span><br />
<span class="key">Print</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;Multiplication&nbsp;of&nbsp;v1:&nbsp;'v1&nbsp;*&nbsp;5'&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;=&gt;&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">v1</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="num">5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;&nbsp;5:&nbsp;implicite&nbsp;conversion&nbsp;using&nbsp;the&nbsp;conversion-constructor,</span><br />
<span class="com">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;short_cut&nbsp;of&nbsp;point2D(5,&nbsp;)&nbsp;or&nbsp;point2D(5)</span><br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output example:<br \>
<div class="fb_indent"><pre class="fb_pre">
Construction of v1: 'Dim As point2D v1 = point2D(2, 3)'
  => (2, 3)

Addition to v1: 'v1 + 4'
  => (6, 3)

Multiplication of v1: 'v1 * 5'
  => 10
					</pre>In this case, it is dangerous to declare a multi-parameter constructor with optional parameters, because the compiler can interpret one of its forms as a conversion-constructor.<br \>
<br \>
</div></div>A workaround: define a default constructor, and the multi-parameter constructor but without optional parameters (or at least one non-optional parameter without considering the first one).<br \>
<br \>
</div><b>Copy-constructor:</b><br \>
<div class="fb_indent">The copy-constructor is a special member procedure that takes as input a reference to an object of the same type, and constructs a new object by copying it.<br \>
If the user does not declare a copy-constructor, the compiler generates (if needed) a copy-constructor for him. The declaration of a copy-assignment operator (see above) does not remove the generation by the compiler of a copy-constructor.<br \>
<br \>
It will sometimes be necessary to create a copy constructor. The purpose of this kind of constructor is to initialize an object when instantiating it from another object.<br \>
Any Type has if needed an implicit copy constructor automatically generated by the compiler, whose sole purpose is to copy the fields of the object to be copied one by one into the fields of the object to be instantiated.<br \>
However, this implicit copy constructor will not always be enough, and the user will sometimes have to provide one explicitly.<br \>
<br \>
This will be particularly the case when some data objects have been allocated dynamically (only member pointers in the Type for object aggregation). A shallow copy of the fields of one object in another would only copy the pointers, not the data pointed. Thus, changing this data for one object would result in the modification of the other object's data, which would probably not be the desired effect.<br \>
<br \>
If the user implements a copy-constructor, it is recommend to also implement a copy-assignment operator so that the meaning of the code is clear.<br \>
<br \>
In addition to the explicit syntax for calling the copy-constructor, this one is also called when an object is passed by value to a procedure, and when a function returns an object by value by using the <i>'Return'</i> keyword.<br \>
<br \>
For the 'ZstringChain' Type defined above, the user needs a copy constructor:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;implement&nbsp;a&nbsp;zstring&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">ZString</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="wrd">pz</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;define&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;default&nbsp;constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">size</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;constructor&nbsp;with&nbsp;as&nbsp;parameter&nbsp;the&nbsp;chain&nbsp;size</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">zc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">)</span>&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;copy&nbsp;constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Destructor</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;destructor</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;&nbsp;<span class="com">''&nbsp;reset&nbsp;the&nbsp;chain&nbsp;pointer</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">size</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">CAllocate</span><span class="oth">(</span><span class="wrd">size</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span><span class="oth">,</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="key">ZString</span><span class="oth">))</span>&nbsp;&nbsp;<span class="com">''&nbsp;allocate&nbsp;memory&nbsp;for&nbsp;the&nbsp;chain</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">zc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">CAllocate</span><span class="oth">(</span><span class="key">Len</span><span class="oth">(*</span><span class="wrd">zc.pz</span><span class="oth">)</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span><span class="oth">,</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="key">ZString</span><span class="oth">))</span>&nbsp;&nbsp;<span class="com">''&nbsp;allocate&nbsp;memory&nbsp;for&nbsp;the&nbsp;new&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">*</span><span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">*</span><span class="wrd">zc.pz</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;initialize&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Destructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Deallocate</span>&nbsp;<span class="wrd">This.pz</span>&nbsp;&nbsp;<span class="com">''&nbsp;free&nbsp;the&nbsp;allocated&nbsp;memory&nbsp;if&nbsp;necessary</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;reset&nbsp;the&nbsp;chain&nbsp;pointer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<span class="key">End</span>&nbsp;<span class="key">Destructor</span><br />
<br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="wrd">zc1</span>&nbsp;&nbsp;<span class="com">''&nbsp;instantiate&nbsp;a&nbsp;non&nbsp;initialized&nbsp;chain&nbsp;:&nbsp;useless</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="wrd">zc2</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">(</span><span class="num">9</span><span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;instantiate&nbsp;a&nbsp;szstring&nbsp;chain&nbsp;of&nbsp;9&nbsp;useful&nbsp;characters</span><br />
<span class="com">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;shortcut:&nbsp;Dim&nbsp;As&nbsp;ZstringChain&nbsp;zc2&nbsp;=&nbsp;9</span><br />
<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">&quot;FreeBASIC&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;fill&nbsp;up&nbsp;the&nbsp;chain&nbsp;with&nbsp;9&nbsp;characters</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc2&nbsp;chain:&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;chain</span><br />
<span class="key">Print</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="wrd">zc3</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">zc2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;instantiate&nbsp;a&nbsp;new&nbsp;szstring&nbsp;chain&nbsp;by&nbsp;copy&nbsp;construction</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc3&nbsp;chain&nbsp;(zc3&nbsp;copy&nbsp;constructed&nbsp;from&nbsp;zc2):&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;chain</span><br />
<span class="key">Print</span><br />
<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">&quot;modified&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;modify&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc3&nbsp;chain&nbsp;(modified):&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">Print</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc2&nbsp;chain:&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;copied&nbsp;chain&nbsp;(not&nbsp;modified)</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output:<br \>
<div class="fb_indent"><pre class="fb_pre">
zc2 chain:
'FreeBASIC'

zc3 chain (zc3 copy constructed from zc2):
'FreeBASIC'

zc3 chain (modified):
'modified'

zc2 chain:
'FreeBASIC'
					</pre></div></div></div></div><u>Destructor</u><br \>
<div class="fb_indent">The destructor function is the inverse of constructor function. It is called when an objects is destroyed.<br \>
The destructor is commonly used to "clean up" when an object is no longer necessary. The destructor cannot have parameters.<br \>
<br \>
If none destructor is explicitly defined, the compiler will generate (if needed) a destructor. The user can override this behavior by declaring and defining explicitly its own destructor.<br \>
If the user defines his own destructor, implicit destruction operations are always done posterior to the user's destruction code execution.<br \>
<br \>
The destructor is called when one of the following events occurs:<br \>
<div class="fb_indent"><b>-</b> An object created using the New operator is explicitly destroyed using the Delete operator.<br \>
<b>-</b> A local object with block scope goes out of scope.<br \>
<b>-</b> A program terminates and global or static objects exist.<br \>
<br \>
</div>If a base Type or data member has an accessible destructor, and if the Type does not declare a destructor, the compiler generates one.<br \>
<br \>
Order of destruction:<br \>
<div class="fb_indent"><b>-</b> The Type destructor is called<br \>
<b>-</b> If the Type has virtual member procedures (including these inherited from its Base), the virtual-pointer (vptr) is set to point to the virtual-table (vtbl) of the Type.<br \>
<b>-</b> The body of the Type destructor procedure is executed.<br \>
<b>-</b> Destructors for base Types are called in the reverse order of declaration.<br \>
<br \>
</div></div><u>Constructors and destructors when inheritance</u><br \>
<div class="fb_indent">How to call constructors and destructors of base Types when instantiating and destroying a derived Type instance?<br \>
The compiler cannot know which constructor to call among the different overloaded constructors potentially present. To call another constructor of a base Type than the constructor taking no parameter, use the keyword <i>'Base ()'</i> specifying the parameters to pass, and this, only authorized on the first code line of the calling constructor.<br \>
<br \>
On the other hand, it is useless to specify the destructor to call, since this one is unique. The user must not call the destructors of the base Types themselves, the compiler does it on its own by chaining the destructors.<br \>
<br \>
Example - Explicit call of the base Type constructor ('Child' Type extends 'Parent' Type):<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">Parent</span>&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;parent&nbsp;type</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">I</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">i0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Destructor</span>&nbsp;<span class="oth">()</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">Parent</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;<span class="com">''&nbsp;define&nbsp;parent&nbsp;Type&nbsp;constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Parent.Constructor()&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">Parent</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">i0</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;&nbsp;<span class="com">''&nbsp;define&nbsp;parent&nbsp;Type&nbsp;constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.I</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">i0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Parent.Constructor(Byval&nbsp;As&nbsp;Integer)&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Destructor</span>&nbsp;<span class="wrd">Parent</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;<span class="com">''&nbsp;define&nbsp;parent&nbsp;Type&nbsp;destructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Parent.Destructor()&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">Destructor</span><br />
<br />
<span class="key">Type</span>&nbsp;<span class="wrd">Child</span>&nbsp;<span class="key">Extends</span>&nbsp;<span class="wrd">Parent</span>&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;child&nbsp;Type</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Destructor</span>&nbsp;<span class="oth">()</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">Child</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;<span class="com">''&nbsp;define&nbsp;child&nbsp;Type&nbsp;default&nbsp;constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Base</span><span class="oth">(</span><span class="num">123</span><span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;authorize&nbsp;only&nbsp;on&nbsp;the&nbsp;first&nbsp;code&nbsp;line&nbsp;of&nbsp;the&nbsp;constructor&nbsp;body</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;Child.Constructor()&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Destructor</span>&nbsp;<span class="wrd">Child</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;<span class="com">''&nbsp;define&nbsp;child&nbsp;Type&nbsp;destructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;&nbsp;&nbsp;Child.Destructor()&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">Destructor</span><br />
<br />
<br />
<span class="key">Scope</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">Child</span>&nbsp;<span class="wrd">c</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span><br />
<span class="key">End</span>&nbsp;<span class="key">Scope</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output:<br \>
<div class="fb_indent"><pre class="fb_pre">
Parent.Constructor(Byval As Integer)
  Child.Constructor()

  Child.Destructor()
Parent.Destructor()
				</pre>If it was not specified that the constructor to be called for the base Type was the constructor taking an Integer parameter, the compiler would have called the default constructor of the base Type (in the above example, one can put in comment the line <i>'Base(123)'</i> and execute again to see this different behavior).<br \>
<br \>
</div></div>If the Type derives from several base Types (multiple-level inheritance), each derived Type constructor can explicitly call only one constructor, the one of its direct base Type, thus the all constituting a chaining of the base constructors.<br \>
<br \>
When using inheritance polymorphism (sub-type polymorphism), the object are manipulated through base Type pointers or references:<br \>
<div class="fb_indent"><b>-</b> If at least one derived Type has an explicit destructor defined, all its base destructors must be virtual so that the destruction can start at this most derived Type and works its way down to the last base Type.<br \>
<b>-</b> To do this, it may be necessary to add virtual destructors with an empty body anywhere an explicit destruction was not yet required, in order to supersede each non-virtual implicit destructor built by the compiler.<br \>
<br \>
</div>Note:<br \>
<div class="fb_indent"><b>-</b> When a derived Type has a base Type where a default constructor or copy constructor or destructor is defined (implicitly or explicitly), the compiler defines a default constructor or copy constructor or destructor for that derived Type.<br \>
<b>-</b> The built-in 'Object' Type having a default-constructor and a copy-constructor both defined implicitly, so all Types deriving (directly or indirectly) from 'Object' have at least implicitly a default constructor and copy constructor.<br \>
<br \>
</div></div><u>Virtual procedures calls in constructors and destructors</u><br \>
<div class="fb_indent">It is usually safe to call any member procedure from within a constructor or destructor because the object is completely set up (virtual tables are initialized and so on) prior to the execution of the first line of user code. However, it is potentially unsafe for a member procedure to call a virtual member procedure for an abstract base Type during construction or destruction.<br \>
<br \>
Be careful when calling virtual procedures in constructors or destructor, because the procedures that are called in the base constructors or destructor is the base Type versions, not the derived Type versions. When such a virtual procedure is called, the procedure invoked is the procedure defined for the constructor's or destructor's own Type (or inherited from its Bases).<br \>
<br \>
</div><div style="text-align: center;"><a href="#ProPgCtorsAssignDtorsTop">Back to top</a></div><br \>
<a name="ProPgCtorsAssignDtors2"></a><br \>
</div><div class="fb_sect_title">2. '=' Assignment-operators</div><div class="fb_sect_cont"><br \>
Among all '=' assignment-operators, there is a specific one that takes as input a reference to an object of the same type, and makes a copy of it (without creating a new object).<br \>
It is the copy-assignment operator.<br \>
<br \>
<u>Copy-assignment operator</u><br \>
<div class="fb_indent">If the user does not declare a copy-assignment operator, the compiler generates (if needed) a copy-assignment operator for him. The declaration of a copy-constructor (see above) does not remove the generation by the compiler of a copy-assignment operator.<br \>
<br \>
A copy-assignment operator must be defined if the implicit copy is not sufficient.<br \>
This happens in cases when the object manages dynamically allocated memory or other resources which need to be specially copied (for example if a member pointer points to dynamically allocated memory, the implicit '=' assignment operator will simply copy the pointer value instead of allocate memory and then perform the copy of data).<br \>
<br \>
If the user implements a copy-assignment operator, it is recommend to also implement a copy-constructor so that the meaning of the code is clear.<br \>
<br \>
In addition to the explicit syntax for calling the copy-assignment operator, this one is also called when a function returns an object by value by using the <i>'Function ='</i> keyword.<br \>
<br \>
For the 'ZstringChain' Type defined above, the user needs also a copy-assignment operator (see the 'rule of three' in 'advanced #2' page):<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;implement&nbsp;a&nbsp;zstring&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">ZString</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="wrd">pz</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;define&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;default&nbsp;constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">size</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;constructor&nbsp;with&nbsp;as&nbsp;parameter&nbsp;the&nbsp;chain&nbsp;size</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">zc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">)</span>&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;copy&nbsp;constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Operator</span>&nbsp;<span class="key">Let</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">zc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">)</span>&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;copy&nbsp;assignment&nbsp;operator</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Destructor</span>&nbsp;<span class="oth">()</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;declare&nbsp;the&nbsp;explicit&nbsp;destructor</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;&nbsp;<span class="com">''&nbsp;reset&nbsp;the&nbsp;chain&nbsp;pointer</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">size</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">CAllocate</span><span class="oth">(</span><span class="wrd">size</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span><span class="oth">,</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="key">ZString</span><span class="oth">))</span>&nbsp;&nbsp;<span class="com">''&nbsp;allocate&nbsp;memory&nbsp;for&nbsp;the&nbsp;chain</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">zc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">CAllocate</span><span class="oth">(</span><span class="key">Len</span><span class="oth">(*</span><span class="wrd">zc.pz</span><span class="oth">)</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span><span class="oth">,</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="key">ZString</span><span class="oth">))</span>&nbsp;&nbsp;<span class="com">''&nbsp;allocate&nbsp;memory&nbsp;for&nbsp;the&nbsp;new&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">*</span><span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">*</span><span class="wrd">zc.pz</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;initialize&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Operator</span>&nbsp;<span class="wrd">ZstringChain.Let</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">zc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="oth">@</span><span class="wrd">zc</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="oth">@</span><span class="key">This</span>&nbsp;<span class="key">Then</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;avoid&nbsp;self&nbsp;assignment&nbsp;destroying&nbsp;the&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Deallocate</span>&nbsp;<span class="wrd">This.pz</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;free&nbsp;the&nbsp;allocated&nbsp;memory&nbsp;if&nbsp;necessary</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">CAllocate</span><span class="oth">(</span><span class="key">Len</span><span class="oth">(*</span><span class="wrd">zc.pz</span><span class="oth">)</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span><span class="oth">,</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="key">ZString</span><span class="oth">))</span>&nbsp;&nbsp;<span class="com">''&nbsp;allocate&nbsp;memory&nbsp;for&nbsp;the&nbsp;new&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">*</span><span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">*</span><span class="wrd">zc.pz</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;initialize&nbsp;the&nbsp;new&nbsp;chain</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<span class="key">End</span>&nbsp;<span class="key">Operator</span><br />
<br />
<span class="key">Destructor</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Deallocate</span>&nbsp;<span class="wrd">This.pz</span>&nbsp;&nbsp;<span class="com">''&nbsp;free&nbsp;the&nbsp;allocated&nbsp;memory&nbsp;if&nbsp;necessary</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">This.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;reset&nbsp;the&nbsp;chain&nbsp;pointer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<span class="key">End</span>&nbsp;<span class="key">Destructor</span><br />
<br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="wrd">zc1</span>&nbsp;&nbsp;<span class="com">''&nbsp;instantiate&nbsp;a&nbsp;non&nbsp;initialized&nbsp;chain&nbsp;:&nbsp;useless</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="wrd">zc2</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">ZstringChain</span><span class="oth">(</span><span class="num">9</span><span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;instantiate&nbsp;a&nbsp;szstring&nbsp;chain&nbsp;of&nbsp;9&nbsp;useful&nbsp;characters</span><br />
<span class="com">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;shortcut:&nbsp;Dim&nbsp;As&nbsp;ZstringChain&nbsp;zc2&nbsp;=&nbsp;9</span><br />
<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">&quot;FreeBASIC&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;fill&nbsp;up&nbsp;the&nbsp;chain&nbsp;with&nbsp;9&nbsp;characters</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc2&nbsp;chain:&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;chain</span><br />
<span class="key">Print</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">ZstringChain</span>&nbsp;<span class="wrd">zc3</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">zc2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;instantiate&nbsp;a&nbsp;new&nbsp;szstring&nbsp;chain&nbsp;by&nbsp;copy&nbsp;construction</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc3&nbsp;chain&nbsp;(zc3&nbsp;copy&nbsp;constructed&nbsp;from&nbsp;zc2):&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;chain</span><br />
<span class="key">Print</span><br />
<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">&quot;modified&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;modify&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc3&nbsp;chain&nbsp;(modified):&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">Print</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc2&nbsp;chain:&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;copied&nbsp;chain&nbsp;(not&nbsp;modified)</span><br />
<span class="key">Print</span><br />
<span class="wrd">zc3</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">zc2</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc3&nbsp;chain&nbsp;(zc3&nbsp;copy&nbsp;assigned&nbsp;from&nbsp;zc2):&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">Print</span><br />
<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">&quot;changed&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;modify&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc3&nbsp;chain&nbsp;(changed):&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc3.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;new&nbsp;chain</span><br />
<span class="key">Print</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;zc2&nbsp;chain:&quot;</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="oth">*</span><span class="wrd">zc2.pz</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;'&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;print&nbsp;the&nbsp;copied&nbsp;chain&nbsp;(not&nbsp;modified)</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output:<br \>
<div class="fb_indent"><pre class="fb_pre">
zc2 chain:
'FreeBASIC'

zc3 chain (zc3 copy constructed from zc2):
'FreeBASIC'

zc3 chain (modified):
'modified'

zc2 chain:
'FreeBASIC'

zc3 chain (zc3 copy assigned from zc2):
'FreeBASIC'

zc3 chain (changed):
'changed'

zc2 chain:
'FreeBASIC'
				</pre></div></div></div><div style="text-align: center;"><a href="#ProPgCtorsAssignDtorsTop">Back to top</a></div><br \>
<a name="ProPgCtorsAssignDtors3"></a><br \>
</div><div class="fb_sect_title">3. Processing variable-length arrays as members of Type</div><div class="fb_sect_cont"><br \>
A variable-length array is not a pseudo-object like a variable-length string, because there is no default copy-constructor and copy-assignment operators as for a variable-length string.<br \>
<br \>
But when a variable-length array is declared in a Type, the compiler build a default copy-constructor and a default copy-assignment operator for the Type. It includes all code for sizing the destination array and copying the data from the source array, if needed:<br \>
<div class="fb_indent">Example for automatic array sizing and copying by the compiler:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">UDT</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">array</span><span class="oth">(</span><span class="key">Any</span><span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u1</span><span class="oth">,</span>&nbsp;<span class="wrd">u2</span><br />
<br />
<span class="key">ReDim</span>&nbsp;<span class="wrd">u1.array</span><span class="oth">(</span><span class="num">1</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">9</span><span class="oth">)</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u1.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u1.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">u1.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
&nbsp;<br />
<span class="wrd">u2</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u1</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u2.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u2.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">u2.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">);</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Print</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u3</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u1</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u3.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u3.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">u3.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">);</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Print</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output:<br \>
<div class="fb_indent"><pre class="fb_pre">
 1 2 3 4 5 6 7 8 9
 1 2 3 4 5 6 7 8 9
				</pre></div></div></div>If the user want to specify his own copy-constructor and copy-assignment operator (to process additional complex field members for example), the above automatic array sizing and copying by the compiler is broken:<br \>
<div class="fb_indent">Example for automatic array sizing and copying by the compiler broken by an explicit copy-constructor and copy-assignment operator:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">UDT</span><br />
&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">array</span><span class="oth">(</span><span class="key">Any</span><span class="oth">)</span><br />
&nbsp;&nbsp;<span class="com">'user&nbsp;fields</span><br />
&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Operator</span>&nbsp;<span class="key">Let</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;constructor</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;copy-constructor</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Operator</span>&nbsp;<span class="wrd">UDT.Let</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;copy-assignement&nbsp;operator</span><br />
<span class="key">End</span>&nbsp;<span class="key">Operator</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u1</span><span class="oth">,</span>&nbsp;<span class="wrd">u2</span><br />
<br />
<span class="key">ReDim</span>&nbsp;<span class="wrd">u1.array</span><span class="oth">(</span><span class="num">1</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">9</span><span class="oth">)</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u1.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u1.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;<span class="wrd">u1.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
&nbsp;<br />
<span class="wrd">u2</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u1</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u2.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u2.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">u2.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">);</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Print</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u3</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u1</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u3.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u3.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">u3.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">);</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Print</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output (none):<br \>
<div class="fb_indent"><pre class="fb_pre">
				</pre></div></div></div>The elementary variable-length array member cannot be copied as a pseudo-object like a variable-length string member, because there is not implicit assignment (referring to the above example, 'This.array = u.array' is disallowed).<br \>
The user must code explicitly the sizing and the copying of the array member:<br \>
<div class="fb_indent">Example for array sizing and copying explicitly set in the user copy-constructor and copy-assignment operator:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="def">#include&nbsp;&quot;crt/string.bi&quot;<br />
</span><br />
<span class="key">Type</span>&nbsp;<span class="wrd">UDT</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">array</span><span class="oth">(</span><span class="key">Any</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'user&nbsp;fields</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Operator</span>&nbsp;<span class="key">Let</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;constructor</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;copy-constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="key">Then</span>&nbsp;&nbsp;<span class="com">''&nbsp;explicit&nbsp;array&nbsp;sizing&nbsp;and&nbsp;copying</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ReDim</span>&nbsp;<span class="wrd">This.array</span><span class="oth">(</span><span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">memcpy</span><span class="oth">(@</span><span class="wrd">This.array</span><span class="oth">(</span><span class="key">LBound</span><span class="oth">(</span><span class="wrd">This.array</span><span class="oth">)),</span>&nbsp;<span class="oth">@</span><span class="wrd">u.array</span><span class="oth">(</span><span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)),</span>&nbsp;<span class="oth">(</span><span class="key">UBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="oth">-</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span><span class="oth">)</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(@</span><span class="wrd">u.array</span><span class="oth">(</span><span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">))))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Operator</span>&nbsp;<span class="wrd">UDT.Let</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;copy-assignement&nbsp;operator</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="oth">@</span><span class="key">This</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="oth">@</span><span class="wrd">u</span>&nbsp;<span class="key">And</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="key">Then</span>&nbsp;&nbsp;<span class="com">''&nbsp;explicit&nbsp;array&nbsp;sizing&nbsp;and&nbsp;copying</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ReDim</span>&nbsp;<span class="wrd">This.array</span><span class="oth">(</span><span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">memcpy</span><span class="oth">(@</span><span class="wrd">This.array</span><span class="oth">(</span><span class="key">LBound</span><span class="oth">(</span><span class="wrd">This.array</span><span class="oth">)),</span>&nbsp;<span class="oth">@</span><span class="wrd">u.array</span><span class="oth">(</span><span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)),</span>&nbsp;<span class="oth">(</span><span class="key">UBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="oth">-</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">)</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span><span class="oth">)</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(@</span><span class="wrd">u.array</span><span class="oth">(</span><span class="key">LBound</span><span class="oth">(</span><span class="wrd">u.array</span><span class="oth">))))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<span class="key">End</span>&nbsp;<span class="key">Operator</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u1</span><span class="oth">,</span>&nbsp;<span class="wrd">u2</span><br />
<br />
<span class="key">ReDim</span>&nbsp;<span class="wrd">u1.array</span><span class="oth">(</span><span class="num">1</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">9</span><span class="oth">)</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u1.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u1.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">u1.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
&nbsp;<br />
<span class="wrd">u2</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u1</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u2.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u2.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">u2.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">);</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Print</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u3</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u1</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u3.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u3.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">u3.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">);</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Print</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output:<br \>
<div class="fb_indent"><pre class="fb_pre">
 1 2 3 4 5 6 7 8 9
 1 2 3 4 5 6 7 8 9
				</pre></div></div></div>Another elegant possibility is to keep this sizing/copying automatically coded by the compiler, but by simply calling it explicitly. For this, an obvious solution for the member array is to no longer put it at the level of the Type itself, but rather in another specific Type, but inherited (seen from the outside, it is exactly the same):<br \>
<div class="fb_indent">Example for using a base Type including the dynamic array member:<br \>
<div class="fb_indent"><tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">UDT0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">array</span><span class="oth">(</span><span class="key">Any</span><span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Type</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="key">Extends</span>&nbsp;<span class="wrd">UDT0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'user&nbsp;fields</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Constructor</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Declare</span>&nbsp;<span class="key">Operator</span>&nbsp;<span class="key">Let</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;constructor</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Constructor</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;copy-constructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Base</span><span class="oth">(</span><span class="wrd">u</span><span class="oth">)</span>&nbsp;&nbsp;<span class="com">''&nbsp;inherited&nbsp;array&nbsp;sizing&nbsp;and&nbsp;copying&nbsp;from&nbsp;Base&nbsp;copy-constructor</span><br />
<span class="key">End</span>&nbsp;<span class="key">Constructor</span><br />
<br />
<span class="key">Operator</span>&nbsp;<span class="wrd">UDT.Let</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">u</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'code&nbsp;for&nbsp;user&nbsp;fields&nbsp;in&nbsp;copy-assignement&nbsp;operator</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Cast</span><span class="oth">(</span><span class="wrd">UDT0</span><span class="oth">,</span>&nbsp;<span class="key">This</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u</span>&nbsp;&nbsp;<span class="com">''&nbsp;inherited&nbsp;array&nbsp;sizing&nbsp;and&nbsp;copying&nbsp;from&nbsp;Base&nbsp;copy-assignement&nbsp;operator</span><br />
<span class="key">End</span>&nbsp;<span class="key">Operator</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u1</span><span class="oth">,</span>&nbsp;<span class="wrd">u2</span><br />
<br />
<span class="key">ReDim</span>&nbsp;<span class="wrd">u1.array</span><span class="oth">(</span><span class="num">1</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">9</span><span class="oth">)</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u1.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u1.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">u1.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
&nbsp;<br />
<span class="wrd">u2</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u1</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u2.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u2.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">u2.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">);</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Print</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UDT</span>&nbsp;<span class="wrd">u3</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">u1</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">I</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">LBound</span><span class="oth">(</span><span class="wrd">u3.array</span><span class="oth">)</span>&nbsp;<span class="key">To</span>&nbsp;<span class="key">UBound</span><span class="oth">(</span><span class="wrd">u3.array</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">u3.array</span><span class="oth">(</span><span class="wrd">I</span><span class="oth">);</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">I</span><br />
<span class="key">Print</span><br />
<br />
<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></tt><br />
Output:<br \>
<div class="fb_indent"><pre class="fb_pre">
 1 2 3 4 5 6 7 8 9
 1 2 3 4 5 6 7 8 9
				</pre></div></div></div><div style="text-align: center;"><a href="#ProPgCtorsAssignDtorsTop">Back to top</a></div><br \>
<br \>
</div><div class="fb_sect_title">See also</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgConstructor.html">Constructor</a></tt>, <tt><a href="KeyPgDestructor.html">Destructor</a></tt><br \>
<li> <tt><a href="KeyPgOpAssignment.html">Operator =[&gt;] (Assignment)</a></tt>, <tt><a href="KeyPgOpLet.html">Operator Let (Assignment)</a></tt><br \>
<li> <a href="ProPgCtorsDtors.html">Constructors and Destructors (basics)</a><br \>
<li> <a href="ProPgCtorsAssignDtors2.html">Constructors, '=' Assignment-Operators, and Destructors (advanced, part #2)</a><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
