<html>
<head>
<title>File I/O with FreeBASIC</title>
<link rel="stylesheet" type="text/css" href="style.css">
<meta charset="UTF-8">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">File I/O with FreeBASIC</div>
<div id="fb_tab_r">&nbsp;<a href="00index.html"><img src="images/fblogo_mini.gif" /></a></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	<br \>
In FreeBASIC, there are 4 possible ways to perform file I/O:<br \>
<br \>
1. Using the built-in BASIC commands like <tt><a href="KeyPgOpen.html">Open</a></tt> , <tt><a href="KeyPgGetfileio.html">Get</a></tt>, <tt><a href="KeyPgPutfileio.html">Put</a></tt>, and <tt><a href="KeyPgClose.html">Close</a></tt>. This way is mostly portable across all platforms supported by FreeBASIC. Open files are identified by "file numbers", that are specific to FreeBASIC and can't be passed into functions from below.<br \>
<br \>
2. Using the C stream I/O functions like fopen, fread, ftell, fclose (see Stream I/O in <a href="ProPgCruntime.html">C Standard Library Functions</a>) of the C library FreeBASIC relies on. This is slightly faster than and adds a few features beyond method above, and still well portable. Open files are identified by file pointers, as in the C language, again unique to this access method.  The <tt><a href="KeyPgFileattr.html">FileAttr</a></tt> function can be used to return a stream I/O pointer from a file number as in 1. above.<br \>
<br \>
3. Using the C low-level I/O functions like _open, _read, _write, _close (see Low Level I/O in <a href="ProPgCruntime.html">C Standard Library Functions</a>). Those functions should be portable, but so far headers are available for Win32 only, so code using them will not compile to any other platform by now.<br \>
<br \>
4. Talk directly to the OS kernel (DOS: use DOS and DPMI INT's , Win32: use API calls like CreateFile, WriteFile). This is no longer portable. Files are identified by handles generated by and specific to the OS kernel.<br \>
<br \>
This example shows methods 1. and 2. described above:<br \>
<br \>
<div class="fb_sect_title">Example</div><div class="fb_sect_cont"><br \>
<tt><div class="freebasic">
<span class="com">'====&nbsp;File&nbsp;I/O&nbsp;example&nbsp;/&nbsp;2018-05-18&nbsp;====</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span>&nbsp;<span class="wrd">fileName</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">&quot;test_123.tmp&quot;</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">ULong</span>&nbsp;<span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">99</span><span class="oth">)</span>&nbsp;<span class="com">'100&nbsp;x&nbsp;4&nbsp;bytes</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">numItems</span><span class="oth">,</span>&nbsp;<span class="wrd">result</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="oth">!</span><span class="quo">&quot;\n====&nbsp;Using&nbsp;the&nbsp;C&nbsp;Runtime&nbsp;(CRT)&nbsp;file&nbsp;I/O&nbsp;====\n&quot;</span><br />
<br />
<span class="def">#include&nbsp;Once&nbsp;&quot;crt/stdio.bi&quot;<br />
</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">FILE</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="wrd">filePtr</span><br />
<br />
<span class="com">'open&nbsp;in&nbsp;binary&nbsp;writing&nbsp;mode</span><br />
<span class="wrd">filePtr</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">fopen</span><span class="oth">(</span><span class="wrd">fileName</span><span class="oth">,</span>&nbsp;<span class="quo">&quot;wb&quot;</span><span class="oth">)</span><br />
<span class="key">If</span>&nbsp;<span class="wrd">filePtr</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'write&nbsp;75&nbsp;x&nbsp;4&nbsp;=&nbsp;300&nbsp;bytes</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">numItems</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">fwrite</span><span class="oth">(@</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">),</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">)),</span>&nbsp;<span class="num">75</span><span class="oth">,</span>&nbsp;<span class="wrd">filePtr</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Number&nbsp;of&nbsp;bytes&nbsp;written:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="key">Str</span><span class="oth">(</span><span class="wrd">numItems</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">)))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Number&nbsp;of&nbsp;items&nbsp;written:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="key">Str</span><span class="oth">(</span><span class="wrd">numItems</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">fclose</span><span class="oth">(</span><span class="wrd">filePtr</span><span class="oth">)</span><br />
<span class="key">Else</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Failed&nbsp;to&nbsp;open&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">fileName</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;&nbsp;for&nbsp;writing&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<br />
<span class="com">'open&nbsp;in&nbsp;binary&nbsp;reading&nbsp;mode</span><br />
<span class="wrd">filePtr</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">fopen</span><span class="oth">(</span><span class="wrd">fileName</span><span class="oth">,</span>&nbsp;<span class="quo">&quot;rb&quot;</span><span class="oth">)</span><br />
<span class="key">If</span>&nbsp;<span class="wrd">filePtr</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'skip&nbsp;the&nbsp;first&nbsp;25&nbsp;items</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="wrd">fseek</span><span class="oth">(</span><span class="wrd">filePtr</span><span class="oth">,</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">))</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="num">25</span><span class="oth">,</span>&nbsp;<span class="wrd">SEEK_SET</span><span class="oth">)</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Failed&nbsp;to&nbsp;seek&nbsp;(set&nbsp;file&nbsp;stream&nbsp;position)&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'try&nbsp;to&nbsp;read&nbsp;the&nbsp;next&nbsp;100&nbsp;items</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">numItems</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">fread</span><span class="oth">(@</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">),</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">)),</span>&nbsp;<span class="num">100</span><span class="oth">,</span>&nbsp;<span class="wrd">filePtr</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Number&nbsp;of&nbsp;bytes&nbsp;read:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="key">Str</span><span class="oth">(</span><span class="wrd">numItems</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">)))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Number&nbsp;of&nbsp;items&nbsp;read:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="key">Str</span><span class="oth">(</span><span class="wrd">numItems</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">fclose</span><span class="oth">(</span><span class="wrd">filePtr</span><span class="oth">)</span><br />
<span class="key">Else</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Failed&nbsp;to&nbsp;open&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">fileName</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;&nbsp;for&nbsp;reading&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<br />
<span class="wrd">result</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">remove</span><span class="oth">(</span><span class="wrd">fileName</span><span class="oth">)</span>&nbsp;<span class="com">'delete&nbsp;file</span><br />
<span class="key">If</span>&nbsp;<span class="wrd">result</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span>&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Removed:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">fileName</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="oth">!</span><span class="quo">&quot;\n====&nbsp;Using&nbsp;the&nbsp;FreeBASIC&nbsp;file&nbsp;I/O&nbsp;====\n&quot;</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span>&nbsp;<span class="wrd">fileNum</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">numBytes</span><br />
<br />
<span class="wrd">fileNum</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">FreeFile</span><br />
<span class="com">'open&nbsp;in&nbsp;binary&nbsp;writing&nbsp;mode</span><br />
<span class="key">If</span>&nbsp;<span class="key">Open</span><span class="oth">(</span><span class="wrd">fileName</span><span class="oth">,</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Binary</span><span class="oth">,</span>&nbsp;<span class="key">Access</span>&nbsp;<span class="key">Write</span><span class="oth">,</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">fileNum</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'write&nbsp;75&nbsp;x&nbsp;4&nbsp;=&nbsp;300&nbsp;bytes</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">result</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Put</span><span class="oth">(</span><span class="wrd">fileNum</span><span class="oth">,</span>&nbsp;<span class="oth">,</span>&nbsp;<span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">),</span>&nbsp;<span class="num">75</span><span class="oth">)</span>&nbsp;<span class="com">'No&nbsp;@buffer(0)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">numBytes</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Seek</span><span class="oth">(</span><span class="wrd">fileNum</span><span class="oth">)</span>&nbsp;<span class="oth">-</span>&nbsp;<span class="num">1</span>&nbsp;<span class="com">'FreeBASIC&nbsp;file&nbsp;position&nbsp;is&nbsp;1-based</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Number&nbsp;of&nbsp;bytes&nbsp;written:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="key">Str</span><span class="oth">(</span><span class="wrd">numBytes</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Number&nbsp;of&nbsp;items&nbsp;written:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="key">Str</span><span class="oth">(</span><span class="wrd">numBytes</span>&nbsp;<span class="oth">\</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">)))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Close</span><span class="oth">(</span><span class="wrd">fileNum</span><span class="oth">)</span><br />
<span class="key">Else</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Failed&nbsp;to&nbsp;open&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">fileName</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;&nbsp;for&nbsp;writing&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<br />
<span class="com">'open&nbsp;in&nbsp;binary&nbsp;reading&nbsp;mode</span><br />
<span class="key">If</span>&nbsp;<span class="key">Open</span><span class="oth">(</span><span class="wrd">fileName</span><span class="oth">,</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Binary</span><span class="oth">,</span>&nbsp;<span class="key">Access</span>&nbsp;<span class="key">Read</span><span class="oth">,</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">fileNum</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'skip&nbsp;the&nbsp;first&nbsp;25&nbsp;items</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Seek</span>&nbsp;<span class="wrd">fileNum</span><span class="oth">,</span>&nbsp;<span class="num">25</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">))</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">1</span>&nbsp;<span class="com">'Note:&nbsp;+1&nbsp;&amp;&nbsp;seek(...)&nbsp;not&nbsp;allowed</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'try&nbsp;to&nbsp;read&nbsp;the&nbsp;next&nbsp;100&nbsp;items</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">result</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Get</span><span class="oth">(</span><span class="wrd">fileNum</span><span class="oth">,</span>&nbsp;<span class="oth">,</span>&nbsp;<span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">),</span>&nbsp;<span class="num">100</span><span class="oth">,</span>&nbsp;<span class="wrd">numBytes</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Number&nbsp;of&nbsp;bytes&nbsp;read:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="key">Str</span><span class="oth">(</span><span class="wrd">numBytes</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Number&nbsp;of&nbsp;items&nbsp;read:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="key">Str</span><span class="oth">(</span><span class="wrd">numBytes</span>&nbsp;<span class="oth">\</span>&nbsp;<span class="key">SizeOf</span><span class="oth">(</span><span class="wrd">buffer</span><span class="oth">(</span><span class="num">0</span><span class="oth">)))</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Close</span><span class="oth">(</span><span class="wrd">fileNum</span><span class="oth">)</span><br />
<span class="key">Else</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Failed&nbsp;to&nbsp;open&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">fileName</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;&nbsp;for&nbsp;reading&quot;</span><br />
<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<br />
<span class="wrd">result</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Kill</span><span class="oth">(</span><span class="wrd">fileName</span><span class="oth">)</span>&nbsp;<span class="com">'delete&nbsp;file</span><br />
<span class="key">If</span>&nbsp;<span class="wrd">result</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span>&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;Killed:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">fileName</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="oth">!</span><span class="quo">&quot;\n====&nbsp;End&nbsp;====\n&quot;</span><br />
</div></tt><br />
 <br \>
<br \>
</div><div class="fb_sect_title">See also</div><div class="fb_sect_cont"><br \>
<ul><li> <a href="CatPgFile.html">File I/O Functions</a><br \>
<li> <a href="ProPgCruntime.html">C Standard Library Functions</a><br \>
<li> <a href="KeyPgGetfileio.html">Get (File I/O Command)</a><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
