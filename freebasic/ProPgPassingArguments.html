<html>
<head>
<title>Passing Arguments to Procedures</title>
<link rel="stylesheet" type="text/css" href="style.css">
<meta charset="UTF-8">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Passing Arguments to Procedures</div>
<div id="fb_tab_r">&nbsp;<a href="00index.html"><img src="images/fblogo_mini.gif" /></a></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Passing information to procedures.<br \>
<br \>
<div class="fb_sect_title">Declaring parameters</div><div class="fb_sect_cont"><br \>
Procedures can get passed information in the form of variables and objects when they are called. In the context of a procedure call, these variables and objects are called arguments. These arguments are then represented as so-called parameters inside the procedure body. Parameters can be used just like any other variable or object.<br \>
<br \>
To specify that a procedure should get passed arguments when called, declare the procedure with a parameter list. A parameter list is a list of one or more names and types that the procedure will use when referring to the arguments that are passed to it. Parameter lists are surrounded by parenthesis.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">Procedure</span>&nbsp;<span class="oth">(</span><span class="wrd">s</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><span class="oth">,</span>&nbsp;<span class="wrd">n</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;The&nbsp;parameters&nbsp;have&nbsp;the&nbsp;values:&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">s</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">&quot;&nbsp;and&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">n</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="wrd">Procedure</span>&nbsp;<span class="quo">&quot;abc&quot;</span><span class="oth">,</span>&nbsp;<span class="num">123</span><br />
</div></tt><br />
will produce the following output:<br \>
<br \>
<pre class="fb_pre">
The parameters have the values: abc and 123
</pre>There are two ways to pass arguments to procedures: by value and by reference. By default, arguments are passed by value unless otherwise specified.<br \>
<br \>
</div><div class="fb_sect_title">Passing arguments by value</div><div class="fb_sect_cont"><br \>
Arguments that are passed by value are not actually passed to procedures; a copy of the argument is made and passed instead. This allows the procedure to modify the copy, and the original variable or object remains unchanged.<br \>
<br \>
When passing objects to procedures by value, the copy is made by calling the copy constructor of the <tt><a href="KeyPgType.html">Type</a></tt> or <tt><a href="KeyPgClass.html">Class</a></tt>.<br \>
<br \>
To specify that an argument should be passed by value, precede the parameter name in the procedure declaration with the <tt><a href="KeyPgByval.html">ByVal</a></tt> keyword:<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">Procedure</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">param</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">param</span>&nbsp;<span class="oth">*=</span>&nbsp;<span class="num">2</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;The&nbsp;parameter&nbsp;'param'&nbsp;=&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">param</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">arg</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">10</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;The&nbsp;variable&nbsp;'arg'&nbsp;before&nbsp;the&nbsp;call&nbsp;=&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">arg</span><br />
<span class="wrd">Procedure</span><span class="oth">(</span><span class="wrd">arg</span><span class="oth">)</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;The&nbsp;variable&nbsp;'arg'&nbsp;after&nbsp;the&nbsp;call&nbsp;=&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">arg</span><br />
</div></tt><br />
will produce the following output:<br \>
<br \>
<pre class="fb_pre">
The variable 'arg' before the call = 10
The parameter 'param' = 20
The variable 'arg' after the call = 10
</pre>Notice how parenthesis surround the arguments - in this case only one, <tt><i>arg</i></tt> - in the procedure call. These parenthesis are optional, but are a common convention to signify a procedure call.<br \>
<br \>
</div><div class="fb_sect_title">Passing arguments by reference</div><div class="fb_sect_cont"><br \>
Unlike arguments that are passed by value, arguments that are passed to procedures by reference really do get passed; no copy is made. This allows the procedure to modify the original variable or object that was passed to it.<br \>
<br \>
A reference is like an alias for a variable or object. Whenever you refer to a reference, you're referring to the actual variable or object that it aliases. In other words, you can think of a reference parameter of a procedure as the argument that is passed to it; any changes made to the reference parameter are actually changes to the argument it represents.<br \>
<br \>
To specify that an argument should be passed by reference, precede the parameter name in the procedure declaration with the <tt><a href="KeyPgByref.html">ByRef</a></tt> keyword:<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">Procedure</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">param</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">param</span>&nbsp;<span class="oth">*=</span>&nbsp;<span class="num">2</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;The&nbsp;parameter&nbsp;'param'&nbsp;=&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">param</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">arg</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">10</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;The&nbsp;variable&nbsp;'arg'&nbsp;before&nbsp;the&nbsp;call&nbsp;=&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">arg</span><br />
<span class="wrd">Procedure</span><span class="oth">(</span><span class="wrd">arg</span><span class="oth">)</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">&quot;The&nbsp;variable&nbsp;'arg'&nbsp;after&nbsp;the&nbsp;call&nbsp;=&nbsp;&quot;</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">arg</span><br />
</div></tt><br />
will produce the following output:<br \>
<br \>
<pre class="fb_pre">
The variable 'arg' before the call = 10
The parameter 'param' = 20
The variable 'arg' after the call = 20
</pre><br \>
</div><div class="fb_sect_title">Manually passing pointers to by-reference parameters</div><div class="fb_sect_cont"><br \>
By specifying the <tt>Byval</tt> keyword in front of an argument to a <tt><a href="KeyPgByref.html">ByRef</a></tt> parameter, an address (usually stored in a pointer) can be passed directly as-is, forcing the <tt>Byref</tt> parameter to reference the same memory location which the address pointed to.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">f</span><span class="oth">(</span>&nbsp;<span class="key">ByRef</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">456</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">123</span><br />
<span class="key">Dim</span>&nbsp;<span class="wrd">pi</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">@</span><span class="wrd">i</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="wrd">i</span><br />
<span class="wrd">f</span><span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">pi</span>&nbsp;<span class="oth">)</span><br />
<span class="key">Print</span>&nbsp;<span class="wrd">i</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">See also</div><div class="fb_sect_cont"><br \>
<ul><li> <a href="ProPgProcedures.html">Procedures Overview</a><br \>
<li> <a href="ProPgReturnValue.html">Returning a Value</a><br \>
<li> <tt><a href="KeyPgDeclare.html">Declare</a></tt><br \>
<li> <tt><a href="KeyPgSub.html">Sub</a></tt><br \>
<li> <tt><a href="KeyPgFunction.html">Function</a></tt><br \>
<li> <tt><a href="KeyPgByval.html">ByVal</a></tt><br \>
<li> <tt><a href="KeyPgByref.html">ByRef</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
