<html>
<head>
<title>Returning Values</title>
<link rel="stylesheet" type="text/css" href="style.css">
<meta charset="UTF-8">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Returning Values</div>
<div id="fb_tab_r">&nbsp;<a href="00index.html"><img src="images/fblogo_mini.gif" /></a></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	<br \>
<div class="fb_sect_title">Returning Values</div><div class="fb_sect_cont"><br \>
<br \>
... refers to the ability of a <tt><a href="KeyPgFunction.html">Function</a></tt> procedure to have a value when the function finishes such that the value can be used in an expression or assigned to a variable.<br \>
<br \>
The value of a function can be returned in three ways:<br \>
<br \>
<tt><div class="freebasic">
<span class="com">''&nbsp;Using&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;to&nbsp;set&nbsp;the&nbsp;return&nbsp;value&nbsp;and&nbsp;continue&nbsp;executing&nbsp;the&nbsp;function:</span><br />
<span class="key">Function</span>&nbsp;<span class="wrd">myfunc1</span><span class="oth">()</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;<span class="wrd">myfunc1</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
<br />
<span class="com">''&nbsp;Using&nbsp;the&nbsp;keyword&nbsp;'Function'&nbsp;to&nbsp;set&nbsp;the&nbsp;return&nbsp;value&nbsp;and&nbsp;continue&nbsp;executing&nbsp;the&nbsp;function:</span><br />
<span class="key">Function</span>&nbsp;<span class="wrd">myfunc2</span><span class="oth">()</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">2</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
<br />
<span class="com">''&nbsp;Using&nbsp;the&nbsp;keyword&nbsp;'Return'&nbsp;to&nbsp;set&nbsp;the&nbsp;return&nbsp;value&nbsp;and&nbsp;immediately&nbsp;exit&nbsp;the&nbsp;function:</span><br />
<span class="key">Function</span>&nbsp;<span class="wrd">myfunc3</span><span class="oth">()</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="num">3</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
</div></tt><br />
<br \>
<tt><div class="freebasic">
<span class="com">''&nbsp;This&nbsp;program&nbsp;demonstrates&nbsp;a&nbsp;function&nbsp;returning&nbsp;a&nbsp;value.</span><br />
<br />
<span class="key">Declare</span>&nbsp;<span class="key">Function</span>&nbsp;<span class="wrd">myFunction</span>&nbsp;<span class="oth">()</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">a</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<br />
<span class="com">'Here&nbsp;we&nbsp;take&nbsp;what&nbsp;myFunction&nbsp;returns&nbsp;and&nbsp;add&nbsp;10.</span><br />
<span class="wrd">a</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">myFunction</span><span class="oth">()</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="num">10</span><br />
<br />
<span class="com">'knowing&nbsp;that&nbsp;myFunction&nbsp;returns&nbsp;10,&nbsp;we&nbsp;get&nbsp;10+10=20&nbsp;and&nbsp;will&nbsp;print&nbsp;20.</span><br />
<span class="key">Print</span>&nbsp;<span class="wrd">a</span>&nbsp;<br />
<br />
<span class="key">Function</span>&nbsp;<span class="wrd">myFunction</span>&nbsp;<span class="oth">()</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;<span class="com">'Here&nbsp;we&nbsp;tell&nbsp;myFunction&nbsp;to&nbsp;return&nbsp;10.</span><br />
&nbsp;&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">10</span>&nbsp;<br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Returning References</div><div class="fb_sect_cont"><br \>
Function results can also be returned by reference, rather than by value. The semantics are quite different.<br \>
<br \>
When assigning a <tt>Byref</tt> function result through a <tt>Function = variable</tt> or <tt>Return variable</tt> statement, the function does not copy and return the variable's value. Instead, it returns a reference to that variable. The caller of the function can modify the variable through the reference returned from the function, without having to use pointers manually. This is very much like <tt><a href="KeyPgByref.html">ByRef</a></tt> parameters.<br \>
<br \>
For more information, refer to: <tt><a href="KeyPgByrefFunction.html">Byref (Function Results)</a></tt><br \>
<br \>
</div><div class="fb_sect_title">Manually returning pointers as-is from Byref functions</div><div class="fb_sect_cont"><br \>
By specifying the <tt>Byval</tt> keyword in front of the result variable in the <tt>Function = variable</tt> or <tt>Return variable</tt> statements, an address (usually stored in a pointer) can be passed directly as-is, forcing the <tt>Byref</tt> function result to reference the same memory location which the address pointed to. For example:<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Dim</span>&nbsp;<span class="key">Shared</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">123</span><br />
<br />
<span class="key">Function</span>&nbsp;<span class="wrd">f</span><span class="oth">(</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">ByRef</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">pi</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">@</span><span class="wrd">i</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">pi</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;or,&nbsp;with&nbsp;RETURN&nbsp;it&nbsp;would&nbsp;look&nbsp;like&nbsp;this:</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">pi</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="wrd">i</span><span class="oth">,</span>&nbsp;<span class="wrd">f</span><span class="oth">(</span>&nbsp;<span class="oth">)</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">See also</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgFunction.html">Function</a></tt><br \>
<li> <tt><a href="KeyPgByrefFunction.html">Byref (Function Results)</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
