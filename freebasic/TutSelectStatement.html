<html>
<head>
<title>The Select Case Statement</title>
<link rel="stylesheet" type="text/css" href="style.css">
<meta charset="UTF-8">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">The Select Case Statement</div>
<div id="fb_tab_r">&nbsp;<a href="00index.html"><img src="images/fblogo_mini.gif" /></a></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	<i>Written by <a href="WikiRick.html">rdc</a></i><br \>
<br \>
The Select Case block can be viewed as an optimized If-ElseIf ladder, and works in much the same way. The standard Select Case can use any of the standard data types for &lt;expression&gt; and the specialized Select Case As Const format is optimized for integer values.<br \>
<br \>
This code snippet shows the syntax of the standard select case. Expression is usually a variable which can be of any of the standard data types, or individual elements of a Type or array. <br \>
<br \>
<tt><div class="freebasic">
<span class="key">Select</span>&nbsp;<span class="key">Case</span>&nbsp;<span class="oth">&lt;</span><span class="wrd">expression</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="oth">&lt;</span><span class="wrd">list</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span>&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="key">Else</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br />
<span class="key">End</span>&nbsp;<span class="key">Select</span><br />
</div></tt><br />
<br \>
The &lt;list&gt; clause of the Case statement can be any of the following formats.<br \>
<br \>
<div class="fb_indent"> Case &lt;value&gt;: Value is one of the supported data types or an enumeration. <br \>
 Case &lt;value&gt; To &lt;value&gt;: Specifies a range of values.<br \>
 Case Is &lt;operator&gt; &lt;value&gt;: Operator is any of the logical operators.<br \>
 Case &lt;value&gt;, &lt;value&gt;, ...: List of values separated with commas.<br \>
 Case &lt;variable&gt;: A variable that contains a value.<br \>
<br \>
</div>The following snippet illustrates how these different formats may be used in a program.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Case</span>&nbsp;<span class="num">47</span><br />
<br />
<span class="key">Case</span>&nbsp;<span class="num">47</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">59</span><br />
<br />
<span class="key">Case</span>&nbsp;<span class="key">Is</span>&nbsp;<span class="oth">&gt;</span>&nbsp;<span class="num">60</span><br />
<br />
<span class="key">Case</span>&nbsp;<span class="num">47</span><span class="oth">,</span>&nbsp;<span class="num">48</span><span class="oth">,</span>&nbsp;<span class="num">53</span><br />
<br />
<span class="key">Case</span>&nbsp;<span class="wrd">keycode</span><br />
</div></tt><br />
<br \>
The Select Case As Const is a faster version of the Select statement designed to work with integer expressions in the range of 0 to 4097.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Select</span>&nbsp;<span class="key">Case</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Const</span>&nbsp;<span class="oth">&lt;</span><span class="wrd">integer_expression</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="oth">&lt;</span><span class="wrd">list</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span>&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="key">Else</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br />
<span class="key">End</span>&nbsp;<span class="key">Select</span><br />
</div></tt><br />
<br \>
The &lt;list&gt; statement formats for the Select Case As Const are limited to values or enumerations of values. That is, the operator expressions are not allowed within a Case As Const.<br \>
<br \>
When a Case block is executed, the statements following the Case keyword up to the next Case keyword (or End Select) will be executed. Only one block of statements within a Case will execute at any one time. If a Case Else is present, then the statements within the Else block will execute if no Case matches the &lt;expression&gt; portion of the Select statement. The following program illustrates using the Select Case statement block.<br \>
<br \>
<tt><div class="freebasic">
<span class="com">'Ascii&nbsp;code&nbsp;of&nbsp;key&nbsp;press</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">keycode</span><br />
<br />
<span class="com">'Loop&nbsp;until&nbsp;esc&nbsp;key&nbsp;is&nbsp;pressed</span><br />
<span class="key">Do</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">keycode</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Asc</span><span class="oth">(</span><span class="key">Inkey</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Select</span>&nbsp;<span class="key">Case</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Const</span>&nbsp;<span class="wrd">keycode</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="num">48</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">57</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;You&nbsp;pressed&nbsp;a&nbsp;number&nbsp;key.&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="num">65</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">90</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;You&nbsp;pressed&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter&nbsp;key.&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="num">97</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">122</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;You&nbsp;pressed&nbsp;a&nbsp;lower&nbsp;case&nbsp;key.&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">Select</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Sleep</span>&nbsp;<span class="num">1</span><br />
<span class="key">Loop</span>&nbsp;<span class="key">Until</span>&nbsp;<span class="wrd">keycode</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">27</span>&nbsp;<span class="com">'27&nbsp;is&nbsp;the&nbsp;ascii&nbsp;code&nbsp;for&nbsp;Escape</span><br />
<br />
<span class="key">End</span><br />
</div></tt><br />
<br \>
In the program, when you press a key, the value is translated to a number using the Asc function. Since this will always be an integer value that is less than 4097 (since ascii character codes range from 0 to 255), the Select Case as Const format is used.<br \>
<br \>
The compiler will check the value of keycode against the Case ranges to see if the block should execute. If keycode falls within a particular range, the Print statement will execute, and then the flow of the program will continue with the next line following the End Select. If keycode doesn't match any Case range, then the program will continue with the next line following the End Select.<br \>
<br \>
A Select Case can usually be translated from an If-Elseif ladder. To illustrate this, the previous program is shown below as an If-ElseIf ladder.<br \>
<br \>
<tt><div class="freebasic">
<span class="com">'Ascii&nbsp;code&nbsp;of&nbsp;key&nbsp;press</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">keycode</span><br />
<br />
<span class="com">'Loop&nbsp;until&nbsp;esc&nbsp;key&nbsp;is&nbsp;pressed</span><br />
<span class="key">Do</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">keycode</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Asc</span><span class="oth">(</span><span class="key">Inkey</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="num">48</span><span class="oth">)</span>&nbsp;<span class="key">And</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&lt;=</span>&nbsp;<span class="num">57</span><span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;You&nbsp;pressed&nbsp;a&nbsp;number&nbsp;key.&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ElseIf</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="num">65</span><span class="oth">)</span>&nbsp;<span class="key">And</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&lt;=</span>&nbsp;<span class="num">90</span><span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;You&nbsp;pressed&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter&nbsp;key.&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ElseIf</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="num">97</span><span class="oth">)</span>&nbsp;<span class="key">And</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&lt;=</span>&nbsp;<span class="num">122</span><span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">&quot;You&nbsp;pressed&nbsp;a&nbsp;lower&nbsp;case&nbsp;key.&quot;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Sleep</span>&nbsp;<span class="num">1</span><br />
<span class="key">Loop</span>&nbsp;<span class="key">Until</span>&nbsp;<span class="wrd">keycode</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">27</span>&nbsp;<span class="com">'27&nbsp;is&nbsp;the&nbsp;ascii&nbsp;code&nbsp;for&nbsp;Escape</span><br />
<br />
<span class="key">End</span><br />
</div></tt><br />
<br \>
If you compare the two programs, you can see that the logic is quite similar, however the Select Case is much more readable and understandable than the If-ElseIf ladder.<br \>
<br \>
<i>Last Reviewed by Sancho3 on February 06, 2018</i><br \>

</div>
</div> 
</div> 
</body>
</html>
